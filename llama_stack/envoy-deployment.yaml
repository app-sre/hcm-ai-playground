apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app: envoy-llama-stack
  name: envoy-llama-stack
  namespace: llama-stack
spec:
  replicas: 1
  selector:
    matchLabels:
      app: envoy-llama-stack
  template:
    metadata:
      labels:
        app: envoy-llama-stack
    spec:
      containers:
      - args:
        - --config-path /usr/local/etc/envoy/envoy.yaml
        - --service-cluster front-proxy
        - --log-level info
        - --component-log-level filter:trace,http:debug,router:debug
        command:
        - /usr/local/bin/envoy
        image: envoyproxy/envoy:v1.25-latest
        name: envoy
        ports:
        - containerPort: 8000
          name: web
        - containerPort: 8001
          name: admin
        volumeMounts:
        - mountPath: /usr/local/etc/envoy
          name: config
          readOnly: true
      volumes:
      - configMap:
          items:
          - key: envoy.yaml
            path: envoy.yaml
          name: envoy-llama-stack
        name: config